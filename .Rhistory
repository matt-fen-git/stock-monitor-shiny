this_stock["2025-01-01"]
this_stock["2025-01-01 / 2025-02-01"]
runApp('app-files')
runApp('app-files')
shiny::runApp('app-files')
shiny::runApp('app-files')
View(all_dips_data)
runApp('app-files')
shiny::runApp('app-files')
runApp('app-files')
runApp('app-files')
runApp('app-files')
runApp('app-files')
faller_with_sparklines <- readRDS("data/debug_data.rds")
faller_with_sparklines <- readRDS("data/debug_data.rds")
faller_with_sparklines <- readRDS("~/Kaggle Projects/shiny-stock-monitor/app-files/data/debug_data.rds")
faller_with_sparklines %>%
gt() %>%
# This will now work for both pre-loaded and custom stocks
gt_plt_sparkline(
column = price_trend,
fig_dim = c(15, 45),
palette = c("#00d4ff", "#00d4ff", "#ff4757", "#00ff88", "#b0b3b8")
) %>%
cols_label(
date = "Dip Date",
stock = "Company",
buy_signal = "Signal",
dip_severity = "Severity",
roc_z = "Z-Score",
adjusted = "Adj Close",
price_change_pct = "% Change",
volume = "Volume",
days_since = "Days Ago",
price_trend = "30-Day Trend"
) %>%
cols_hide(columns = c(open, high, low, close, outlier, vol_relative)) %>%
fmt_date(date, date_style = "yMd") %>%
fmt_number(roc_z, decimals = 2) %>%
fmt_currency(columns = c(adjusted), currency = "USD") %>%
fmt_number(volume, decimals = 0, scale_by = 1e-6, pattern = "{x}M") %>%
cols_move_to_start(columns = c(date, stock, price_trend, buy_signal, dip_severity, roc_z)) %>%
data_color(
columns = roc_z,
method = "numeric",
palette = c("#00FF00", "#FFFF00", "#FF0000"),
domain = c(-4, 0),
reverse = TRUE
) %>%
tab_style(
style = cell_fill(color = "#2a3150"),
locations = cells_body(rows = roc_z <= -2.5)
) %>%
tab_header(
title = md("**Stock Dip Opportunities**"),
subtitle = md("*Scanning for z-score based mean-reversion signals.*")
) %>%
opt_interactive(use_filters = TRUE, use_search = TRUE) %>%
tab_options(
table.background.color = "#151b3d",
table.font.color = "#e8eaed",
column_labels.background.color = "#1a2142",
heading.background.color = "#1a2142"
) %>%
tab_footnote(
footnote = "Z-Score < -2 indicates a statistically significant dip.",
locations = cells_column_labels(columns = roc_z)
)
View(faller_with_sparklines)
str(faller_with_sparklines)
faller_with_sparklines %>%
gt() %>%
# This will now work for both pre-loaded and custom stocks
gt_plt_sparkline(
column = price_trend,
fig_dim = c(15, 45),
palette = c("#00d4ff", "#00d4ff", "#ff4757", "#00ff88", "#b0b3b8")
) %>%
cols_label(
date = "Dip Date",
stock = "Company",
buy_signal = "Signal",
dip_severity = "Severity",
roc_z = "Z-Score",
adjusted = "Adj Close",
price_change_pct = "% Change",
volume = "Volume",
days_since = "Days Ago",
price_trend = "30-Day Trend"
) %>%
cols_hide(columns = c(open, high, low, close, outlier, vol_relative)) %>%
fmt_date(date, date_style = "yMd") %>%
fmt_number(roc_z, decimals = 2) %>%
fmt_currency(columns = c(adjusted), currency = "USD") %>%
fmt_number(volume, decimals = 0, scale_by = 1e-6, pattern = "{x}M") %>%
cols_move_to_start(columns = c(date, stock, price_trend, buy_signal, dip_severity, roc_z)) %>%
data_color(
columns = roc_z,
method = "numeric",
palette = c("#00FF00", "#FFFF00", "#FF0000"),
domain = c(-4, 0),
reverse = TRUE
) %>%
tab_style(
style = cell_fill(color = "#2a3150"),
locations = cells_body(rows = roc_z <= -2.5)
) %>%
tab_header(
title = md("**Stock Dip Opportunities**"),
subtitle = md("*Scanning for z-score based mean-reversion signals.*")
) %>%
# opt_interactive(use_filters = TRUE, use_search = TRUE) %>%
tab_options(
table.background.color = "#151b3d",
table.font.color = "#e8eaed",
column_labels.background.color = "#1a2142",
heading.background.color = "#1a2142"
) %>%
tab_footnote(
footnote = "Z-Score < -2 indicates a statistically significant dip.",
locations = cells_column_labels(columns = roc_z)
)
faller_with_sparklines %>%
gt() %>%
# This will now work for both pre-loaded and custom stocks
gt_plt_sparkline(
column = price_trend,
fig_dim = c(15, 45),
palette = c("#00d4ff", "#00d4ff", "#ff4757", "#00ff88", "#b0b3b8")
) %>%
cols_label(
date = "Dip Date",
stock = "Company",
buy_signal = "Signal",
dip_severity = "Severity",
roc_z = "Z-Score",
adjusted = "Adj Close",
price_change_pct = "% Change",
volume = "Volume",
days_since = "Days Ago",
price_trend = "30-Day Trend"
) %>%
cols_hide(columns = c(open, high, low, close, outlier, vol_relative)) %>%
fmt_date(date, date_style = "yMd") %>%
fmt_number(roc_z, decimals = 2) %>%
fmt_currency(columns = c(adjusted), currency = "USD") %>%
fmt_number(volume, decimals = 0, scale_by = 1e-6, pattern = "{x}M") %>%
cols_move_to_start(columns = c(date, stock, price_trend, buy_signal, dip_severity, roc_z)) %>%
data_color(
columns = roc_z,
method = "numeric",
palette = c("#00FF00", "#FFFF00", "#FF0000"),
domain = c(-4, 0),
reverse = TRUE
) %>%
tab_style(
style = cell_fill(color = "#2a3150"),
locations = cells_body(rows = roc_z <= -2.5)
) %>%
tab_header(
title = md("**Stock Dip Opportunities**"),
subtitle = md("*Scanning for z-score based mean-reversion signals.*")
) %>%
opt_interactive(use_filters = TRUE, use_search = TRUE) %>%
tab_options(
table.background.color = "#151b3d",
table.font.color = "#e8eaed",
column_labels.background.color = "#1a2142",
heading.background.color = "#1a2142"
) %>%
tab_footnote(
footnote = "Z-Score < -2 indicates a statistically significant dip.",
locations = cells_column_labels(columns = roc_z)
)
faller_with_sparklines %>%
gt() %>%
# This will now work for both pre-loaded and custom stocks
gt_plt_sparkline(
column = price_trend,
fig_dim = c(15, 45),
palette = c("#00d4ff", "#00d4ff", "#ff4757", "#00ff88", "#b0b3b8")
) %>%
cols_label(
date = "Dip Date",
stock = "Company",
buy_signal = "Signal",
dip_severity = "Severity",
roc_z = "Z-Score",
adjusted = "Adj Close",
price_change_pct = "% Change",
volume = "Volume",
days_since = "Days Ago",
price_trend = "30-Day Trend"
) %>%
cols_hide(columns = c(open, high, low, close, outlier, vol_relative)) %>%
fmt_date(date, date_style = "yMd") %>%
fmt_number(roc_z, decimals = 2) %>%
fmt_currency(columns = c(adjusted), currency = "USD") %>%
fmt_number(volume, decimals = 0, scale_by = 1e-6, pattern = "{x}M") %>%
cols_move_to_start(columns = c(date, stock, price_trend, buy_signal, dip_severity, roc_z)) %>%
data_color(
columns = roc_z,
method = "numeric",
palette = c("#00FF00", "#FFFF00", "#FF0000"),
domain = c(-4, 0),
reverse = TRUE
) %>%
tab_style(
style = cell_fill(color = "#2a3150"),
locations = cells_body(rows = roc_z <= -2.5)
) %>%
tab_header(
title = md("**Stock Dip Opportunities**"),
subtitle = md("*Scanning for z-score based mean-reversion signals.*")
) %>%
#opt_interactive(use_filters = TRUE, use_search = TRUE) %>%
tab_options(
table.background.color = "#151b3d",
table.font.color = "#e8eaed",
column_labels.background.color = "#1a2142",
heading.background.color = "#1a2142"
) %>%
tab_footnote(
footnote = "Z-Score < -2 indicates a statistically significant dip.",
locations = cells_column_labels(columns = roc_z)
)
runApp('app-files')
faller_with_sparklines %>%
gt() %>%
# This will now work for both pre-loaded and custom stocks
gt_plt_sparkline(
column = price_trend,
fig_dim = c(15, 45),same_limit = F,
palette = c("#00d4ff", "#00d4ff", "#ff4757", "#00ff88", "#b0b3b8")
) %>%
cols_label(
date = "Dip Date",
stock = "Company",
buy_signal = "Signal",
dip_severity = "Severity",
roc_z = "Z-Score",
adjusted = "Adj Close",
price_change_pct = "% Change",
volume = "Volume",
days_since = "Days Ago",
price_trend = "30-Day Trend"
) %>%
cols_hide(columns = c(open, high, low, close, outlier, vol_relative)) %>%
fmt_date(date, date_style = "yMd") %>%
fmt_number(roc_z, decimals = 2) %>%
fmt_currency(columns = c(adjusted), currency = "USD") %>%
fmt_number(volume, decimals = 0, scale_by = 1e-6, pattern = "{x}M") %>%
cols_move_to_start(columns = c(date, stock, price_trend, buy_signal, dip_severity, roc_z)) %>%
data_color(
columns = roc_z,
method = "numeric",
palette = c("#00FF00", "#FFFF00", "#FF0000"),
domain = c(-4, 0),
reverse = TRUE
) %>%
tab_style(
style = cell_fill(color = "#2a3150"),
locations = cells_body(rows = roc_z <= -2.5)
) %>%
tab_header(
title = md("**Stock Dip Opportunities**"),
subtitle = md("*Scanning for z-score based mean-reversion signals.*")
) %>%
#opt_interactive(use_filters = TRUE, use_search = TRUE) %>%
tab_options(
table.background.color = "#151b3d",
table.font.color = "#e8eaed",
column_labels.background.color = "#1a2142",
heading.background.color = "#1a2142"
) %>%
tab_footnote(
footnote = "Z-Score < -2 indicates a statistically significant dip.",
locations = cells_column_labels(columns = roc_z)
)
source("~/Kaggle Projects/shiny-stock-monitor/processing-scripts/dip_inspector.R")
# Define the function to process each stock dataset
get_dips <- function(symbol_name) {
require(dplyr)
require(tidyverse)
require(TTR)
require(quantmod)
require(future)
require(furrr)
tryCatch({
data <- stock_data_list[[symbol_name]]
if (is.null(data)) return(NULL)
# Calculate ROC with a period of 30 days
roc_data <- ROC(Cl(data %>%
subset(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
# Create Z-score
roc_z <- (roc_data - mean(roc_data, na.rm = TRUE)) / sd(roc_data, na.rm = TRUE)
# Join Data together
this_data <- merge(data, roc_z)
# Rename the joined column
colnames(this_data)[ncol(this_data)] <- "roc_z"
z_threshold <- quantile(this_data$roc_z, 0.05, na.rm = TRUE)
# Flag Outlier
this_data$outlier <- ifelse(this_data$roc_z <= -2, 1, 0) # This needs to be investigated better...
this_data$outlier <- ifelse(this_data$roc_z <= z_threshold, 1, 0)
# Convert to a data frame and filter for outliers
this_data_df <-
this_data %>%
as.data.frame() %>%
rownames_to_column("date") %>%
mutate(date = as.Date(date),
Stock = symbol_name) %>%
filter(outlier == 1) %>% #, date >= Sys.Date() - 60) %>%
arrange(desc(date))
names(this_data_df) <-  tolower(sub(".*\\.","",colnames(this_data_df)))
# Add the symbol name column
#this_data_df$symbol_name <- symbol_name
gc()
return(this_data_df)
}, error = function(e) {
# Print error message and return NULL
NULL
cat("Error processing", symbol_name, ":", e$message, "\n")
return(NULL)
})
}
# Initialize a list
all_dips <- list()
# Define the function to process each stock dataset
get_dips <- function(symbol_name) {
require(dplyr)
require(tidyverse)
require(TTR)
require(quantmod)
require(future)
require(furrr)
tryCatch({
data <- stock_data_list[[symbol_name]]
if (is.null(data)) return(NULL)
# Calculate ROC with a period of 30 days
roc_data <- ROC(Cl(data %>%
subset(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
# Create Z-score
roc_z <- (roc_data - mean(roc_data, na.rm = TRUE)) / sd(roc_data, na.rm = TRUE)
# Join Data together
this_data <- merge(data, roc_z)
# Rename the joined column
colnames(this_data)[ncol(this_data)] <- "roc_z"
z_threshold <- quantile(this_data$roc_z, 0.05, na.rm = TRUE)
# Flag Outlier
this_data$outlier <- ifelse(this_data$roc_z <= -2, 1, 0) # This needs to be investigated better...
this_data$outlier <- ifelse(this_data$roc_z <= z_threshold, 1, 0)
# Convert to a data frame and filter for outliers
this_data_df <-
this_data %>%
as.data.frame() %>%
rownames_to_column("date") %>%
mutate(date = as.Date(date),
Stock = symbol_name) %>%
filter(outlier == 1) %>% #, date >= Sys.Date() - 60) %>%
arrange(desc(date))
names(this_data_df) <-  tolower(sub(".*\\.","",colnames(this_data_df)))
# Add the symbol name column
#this_data_df$symbol_name <- symbol_name
gc()
return(this_data_df)
}, error = function(e) {
# Print error message and return NULL
NULL
cat("Error processing", symbol_name, ":", e$message, "\n")
return(NULL)
})
}
# Initialize a list
all_dips <- list()
# Get tick names
tick_names <- names(stock_data_list)
all_dips_data <- do.call(rbind,purrr::map(tick_names,get_dips,.progress = TRUE))
# Set up parallel processing (adjust workers as needed; leave one core free)
plan(multisession, workers = availableCores() - 1)
# Parallel map with progress (replaces purrr::map for speed)
all_dips_list <- future_map(tick_names, get_dips, .progress = TRUE)
data <- stock_data_list[1]
if (is.null(data)) return(NULL)
# Calculate ROC with a period of 30 days
roc_data <- ROC(Cl(data %>%
subset(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
data
data |> as.data.frame()
data <- stock_data_list[[symbol_name]]
if (is.null(data)) return(NULL)
# Calculate ROC with a period of 30 days
roc_data <- ROC(Cl(data %>%
subset(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
Cl(data)
Cl(data$3M)
Cl(data$3M)
Cl(data$`3M`)
data <- stock_data_list[[`3M`]]
data <- stock_data_list[["3M"]]
# Calculate ROC with a period of 30 days
roc_data <- ROC(Cl(data %>%
subset(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
data
Cl(data)
# Calculate ROC with a period of 30 days
roc_data <- ROC(Cl(data %>%
filter(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
roc_data <- ROC(Cl(data %>%
subset(year(index(.))>=2024)), # I am looking at 2024 only!
n = 1) # <<<< CHANGE LAGGING VALUE HERE..
data
source("~/Kaggle Projects/shiny-stock-monitor/processing-scripts/dip_inspector.R")
# Load your main data list (ensure the path is correct)
stock_data_list <- readRDS("data/stock_data_list.rds")
source("~/Kaggle Projects/shiny-stock-monitor/processing-scripts/dip_inspector.R")
runApp('app-files')
all_dips_data
faller_with_sparklines <- readRDS("~/Kaggle Projects/shiny-stock-monitor/app-files/data/debug_data.rds")
faller_with_sparklines %>%
gt() %>%
# This will now work for both pre-loaded and custom stocks
gt_plt_sparkline(
column = price_trend,
fig_dim = c(15, 45),same_limit = F,
palette = c("#00d4ff", "#00d4ff", "#ff4757", "#00ff88", "#b0b3b8")
) %>%
cols_label(
date = "Dip Date",
stock = "Company",
buy_signal = "Signal",
dip_severity = "Severity",
roc_z = "Z-Score",
adjusted = "Adj Close",
price_change_pct = "% Change",
volume = "Volume",
days_since = "Days Ago",
price_trend = "30-Day Trend"
) %>%
cols_hide(columns = c(open, high, low, close, outlier, vol_relative)) %>%
fmt_date(date, date_style = "yMd") %>%
fmt_number(roc_z, decimals = 2) %>%
fmt_currency(columns = c(adjusted), currency = "USD") %>%
fmt_number(volume, decimals = 0, scale_by = 1e-6, pattern = "{x}M") %>%
cols_move_to_start(columns = c(date, stock, price_trend, buy_signal, dip_severity, roc_z)) %>%
data_color(
columns = roc_z,
method = "numeric",
palette = c("#00FF00", "#FFFF00", "#FF0000"),
domain = c(-4, 0),
reverse = TRUE
) %>%
tab_style(
style = cell_fill(color = "#2a3150"),
locations = cells_body(rows = roc_z <= -2.5)
) %>%
tab_header(
title = md("**Stock Dip Opportunities**"),
subtitle = md("*Scanning for z-score based mean-reversion signals.*")
) %>%
#opt_interactive(use_filters = TRUE, use_search = TRUE) %>%
tab_options(
table.background.color = "#151b3d",
table.font.color = "#e8eaed",
column_labels.background.color = "#1a2142",
heading.background.color = "#1a2142"
) %>%
tab_footnote(
footnote = "Z-Score < -2 indicates a statistically significant dip.",
locations = cells_column_labels(columns = roc_z)
)
source("~/Kaggle Projects/shiny-stock-monitor/processing-scripts/dip_inspector.R")
source("~/Kaggle Projects/shiny-stock-monitor/processing-scripts/dip_inspector.R")
# Save the final compiled data to a CSV file for your Shiny app
fwrite(all_dips_data, "~/Kaggle Projects/shiny-stock-monitor/app-files/data/all_dips_data.csv")
runApp('app-files')
shiny::runApp('app-files')
runApp('app-files')
shiny::runApp('app-files')
runApp('app-files')
runApp('app-files')
shiny::runApp('app-files')
rlang::last_trace()
shiny::runApp('app-files')
install.package("tidyquant")
install.packages("tidyquant")
runApp('app-files')
remove.packages("RobStatTM")
install.packages("RobStatTM")
runApp('app-files')
library(tidyquant)
library(shiny)
library(highcharter)
library(dplyr)
library(xts)
library(TTR)
library(tidyquant)
library(stringr)
remove.packages("tidyquant")
install.packages("tidyquant")
library(tidyquant)
remove.packages("RobStatTM")
library(RobStatTM)
runApp('app-files')
install.packages("RobStatTM")
runApp('app-files')
shiny::runApp('app-files')
